// Generated by CoffeeScript 1.4.0
(function() {
  var superagent;

  superagent = require('superagent');

  exports.route = function(request, response) {
    return superagent.get('https://alpha-api.app.net/stream/0/posts/stream/global').end(function(error, globalTimelineResponse) {
      var globalTimeline;
      globalTimelineResponse.body.numberOfPosts = function() {
        return this.data.length;
      };
      globalTimeline = globalTimelineResponse.body;
      if (error) {
        globalTimeline.errorType = 'Network';
        globalTimeline.error = error;
      } else if (!globalTimeline.data) {
        globalTimeline.data = [];
        globalTimeline.errorType = 'App.net';
        globalTimeline.error = "(#" + globalTimeline.meta.code + ") " + globalTimeline.meta.error_message;
      }
      return response.render('posts-client-side-updates', globalTimelineResponse.body);
    });
  };

}).call(this);
